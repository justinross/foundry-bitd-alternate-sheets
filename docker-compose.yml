---
version: "3.8"

services:
  foundry:
    image: ghcr.io/felddy/foundryvtt:${FOUNDRY_VERSION:-release}
    hostname: bitd-alt-sheets-dev
    env_file:
      - .devcontainer/.env
    volumes:
      # Mount workspace for VS Code
      - .:/workspaces/${MODULE_NAME:-bitd-alternate-sheets}:cached
      # Foundry data persistence (inside workspace, gitignored)
      - ./foundry-data:/data
      # Mount module into Foundry's modules directory for testing
      - .:/data/Data/modules/${MODULE_NAME:-bitd-alternate-sheets}
      # npm cache persistence
      - bitd-npm-cache:/home/foundry/.npm
    ports:
      - target: 30000
        published: ${FOUNDRY_EXTERNAL_PORT:-30000}
        protocol: tcp

volumes:
  bitd-npm-cache: